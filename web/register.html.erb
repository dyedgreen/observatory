<!DOCTYPE html>
<html lang="en">

  <head>
    <title>Register</title>
    <%= partial "meta_tags.html" %>
    <link href="/static/styles/base.css" rel="stylesheet" type="text/css">
  </head>

  <body>
    <form action="/user/register" method="POST">
      <h1>Register</h1>
      <p>Scan the QR code or copy the secret below.</p>

      <% if error %>
      <p class="error"><%= error %></p>
      <% end %>

      <img class="qr" src="<%= qr_secret %>">
      <p class="code"><%=
        s = ""
        secret.split("").each_slice(4).with_index do |slice, i|
          s << slice.join
          if i == 3
            s << "<br>"
          elsif i < 7
            s << " "
          end
        end
        s
      %></p>

      <input name="username" type="text" value="<%= request.POST['username'] %>" placeholder="Username">
      <input name="code" type="number" placeholder="Enter Code">
      <input name="secret" type="text" value="<%= secret %>" style="display:none">
      <input type="submit" class="button" value="Register">
    </form>
  </body>

</html>
